<%

fieldWrapper = [

	// The expected wrapper to use
	'chimera/field_wrappers/' + template.wrapper + '_' + template.action,

	// The fallback wrapper
	'chimera/field_wrappers/default_' + template.action,

	// If it still doesn't exist, try the list view
	'chimera/field_wrappers/default_list'
];

fieldElement = [

	// The expected element to use
	'chimera/fields/' + template.field + '_' + template.action,

	// The fallback element
	'chimera/fields/default_' + template.action,

	// If it still doesn't exist, try the list view
	'chimera/fields/default_list'
];

fieldEntries = 'chimera/field_wrappers/_entries';

// Render the wrapper
if (print_wrapper !== false) {

	if (data.field.options && data.field.options.title) {
		field_title = data.field.options.title;
	} else {
		field_title = data.field.fieldType.title;
	}

	if (data.field.options && data.field.options.description) {
		field_description = data.field.options.description;
	} else if (data.field.fieldType.options) {
		field_description = data.field.fieldType.options.description;
	}

	if (!field_title && data.field.fieldType.name) {
		field_title = data.field.fieldType.name.titleize();
	}

	wrapper_variables = {
		field_title       : field_title,
		field_description : field_description
	};

	//implement(fieldWrapper, {changeMain: true, wrapper: false}, wrapper_variables);
	switchTemplate(fieldWrapper, wrapper_variables);
}

if (data.field) {
	field_scripts = [
		'chimera/chimera',
		'chimera/chimera_field_wrapper',
		'chimera/chimera_field'
	];

	if (data.field.script_file) {
		field_scripts = field_scripts.concat(data.field.script_file);
	}

	script(field_scripts);

	if (data.field.style_file) {
		style(data.field.style_file);
	}
}

if (print_entries !== false) {
	if (print_wrapper === false) {
		assign('entries');
	}

	//implement(fieldEntries, null, {fieldElement: fieldElement});
	implement(fieldEntries, {fieldElement: fieldElement});
}

%>