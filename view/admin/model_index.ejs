<%
expands('layouts/admin_main');

if (typeof editconnection === 'undefined') {
	var editconnection = '/admin/:modelname/edit/:id';
}

start('chimera-page-title'); -%>
<div class="adminActionHead">
	<span class="title" id="mainTitle"><%= modelName %>: Index</span>
	<div class="buttons">
		<%
			add_link('/admin/:modelname/add', {
				title: 'Add new',
				'class': 'btn btn-primary',
				prepend: '<i class="fa fa-plus"></i> ',
				urlvars: {
					modelname: modelName.underscore()
				}
			})
		%>
	</div>
	<div class="clear"></div>
</div>
<% end('chimera-page-title');

start(store('chimera-view-setting').contentblock) -%>
<table class="table table-striped table-bordered">
	<tr>
		<% for (var i in fields) { %>
		<th><% Paginate.sort({field: fields[i], parentClass: 'activesort'}) %></th>
		<% } %>
		<th>Actions</th>
	</tr>

	<% for (var i in items) { %>
		<% var item = items[i][modelName] %>
		<% if (!item) continue %>
		<tr>
			<% for (var f in fields) { %>
			<td><% if(item && fields) { %> <%= item[fields[f]] %> <% } %></td>
			<% } %>
			<td>
				<%
					add_link(editconnection, {
						title: 'Edit',
						'class': 'btn btn-small editButton',
						content: '<i class="fa fa-pencil"></i> ',
						urlvars: {
							modelname: modelName.underscore(),
							id: item._id
							}
					})
				%>
			</td>
		</tr>
	<% } %>
</table>

<% Paginate.show() %>

<% end(store('chimera-view-setting').contentblock) %>